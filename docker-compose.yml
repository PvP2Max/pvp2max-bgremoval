services:
  withoutbg:
    image: withoutbg/app:latest
    container_name: withoutbg
    environment:
      - PORT=80
      # Uncomment and set if your withoutbg build expects auth:
      # - WITHOUTBG_API_TOKEN=change-me
    ports:
      - "5001:80"
    restart: unless-stopped
    networks:
      - apps-net

  bgremover:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        NEXT_PUBLIC_DEFAULT_SERVICE_TOKEN: ${NEXT_PUBLIC_DEFAULT_SERVICE_TOKEN}
    container_name: bgremover
    depends_on:
      - withoutbg
    env_file:
      - .env
    environment:
      - WITHOUTBG_API_URL=http://withoutbg:5001/api/remove
    ports:
      - "3000:3000"
    restart: unless-stopped
    networks:
      - apps-net

networks:
  apps-net:
    external: true
